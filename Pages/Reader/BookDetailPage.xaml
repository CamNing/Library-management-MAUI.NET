<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="book.Pages.Reader.BookDetailPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             Title="Chi tiáº¿t SÃ¡ch"
             BackgroundColor="#F3F4F6">

    <Grid RowDefinitions="Auto, *">
        <Grid Grid.Row="0" ColumnDefinitions="Auto, *" Padding="20,15" BackgroundColor="#F3F4F6">
            <Border StrokeShape="RoundRectangle 20" 
                    HeightRequest="40" 
                    WidthRequest="40" 
                    BackgroundColor="White" 
                    StrokeThickness="0"
                    HorizontalOptions="Start">
                <Border.Shadow>
                    <Shadow Brush="Black" Offset="0,2" Radius="5" Opacity="0.1"/>
                </Border.Shadow>
                <Label Text="â†" 
                       FontSize="24" 
                       TextColor="#1F2937" 
                       HorizontalOptions="Center" 
                       VerticalOptions="Center"
                       TranslationY="-2"/>
                <Border.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnBackClicked"/>
                </Border.GestureRecognizers>
            </Border>

            <Label Grid.Column="1" 
                   Text="Chi tiáº¿t tÃ¡c pháº©m" 
                   FontSize="18" 
                   FontAttributes="Bold" 
                   TextColor="#1F2937"
                   VerticalOptions="Center"
                   HorizontalOptions="Center"
                   Margin="-40,0,0,0"/>
        </Grid>

        <ScrollView Grid.Row="1" Padding="0,0,0,30">
            <VerticalStackLayout Padding="20" Spacing="20">

                <ActivityIndicator x:Name="LoadingIndicator" 
                                  IsRunning="False" 
                                  IsVisible="False" 
                                  Color="#6C63FF"
                                  HeightRequest="50"
                                  WidthRequest="50"/>

                <VerticalStackLayout x:Name="BookFrame" IsVisible="False" Spacing="20">

                    <Border StrokeShape="RoundRectangle 25" 
                            BackgroundColor="White" 
                            StrokeThickness="0">
                        <Border.Shadow>
                            <Shadow Brush="Black" Offset="0,8" Radius="15" Opacity="0.05"/>
                        </Border.Shadow>

                        <Grid RowDefinitions="Auto, Auto">
                            <Grid BackgroundColor="#F9FAFB" Padding="0,30">
                                <Border StrokeShape="RoundRectangle 10" 
                                        StrokeThickness="0" 
                                        HeightRequest="240" 
                                        WidthRequest="160"
                                        HorizontalOptions="Center"
                                        Shadow="{Null}">
                                    <Image x:Name="CoverImage" 
                                           Aspect="AspectFill"
                                           BackgroundColor="#E5E7EB"/>
                                </Border>
                            </Grid>

                            <VerticalStackLayout Grid.Row="1" Padding="25" Spacing="10">
                                <Label x:Name="TitleLabel" 
                                       FontSize="22" 
                                       FontAttributes="Bold" 
                                       TextColor="#1F2937" 
                                       HorizontalTextAlignment="Center"
                                       LineBreakMode="WordWrap"/>

                                <Label x:Name="AuthorsLabel" 
                                       FontSize="15" 
                                       TextColor="#6C63FF" 
                                       HorizontalOptions="Center"
                                       FontAttributes="Bold"
                                       LineBreakMode="TailTruncation"/>

                                <BoxView HeightRequest="1" Color="#F3F4F6" Margin="20,5"/>

                                <FlexLayout Wrap="Wrap" JustifyContent="Center" Direction="Row" AlignItems="Center">
                                    <Border BackgroundColor="#F3F4F6" StrokeThickness="0" StrokeShape="RoundRectangle 8" Padding="12,6" Margin="4">
                                        <Label x:Name="ManagementCodeLabel" FontSize="12" TextColor="#4B5563"/>
                                    </Border>
                                    <Border BackgroundColor="#F3F4F6" StrokeThickness="0" StrokeShape="RoundRectangle 8" Padding="12,6" Margin="4">
                                        <Label x:Name="CategoryLabel" FontSize="12" TextColor="#4B5563"/>
                                    </Border>
                                    <Border BackgroundColor="#F3F4F6" StrokeThickness="0" StrokeShape="RoundRectangle 8" Padding="12,6" Margin="4">
                                        <Label x:Name="PublishedYearLabel" FontSize="12" TextColor="#4B5563"/>
                                    </Border>
                                </FlexLayout>

                                <Border BackgroundColor="#ECFDF5" StrokeThickness="0" StrokeShape="RoundRectangle 8" Padding="15,8" Margin="0,10,0,0" HorizontalOptions="Center">
                                    <Label x:Name="AvailableQuantityLabel" 
                                           FontSize="14" 
                                           FontAttributes="Bold" 
                                           TextColor="#059669"/>
                                </Border>
                            </VerticalStackLayout>
                        </Grid>
                    </Border>

                    <Border StrokeShape="RoundRectangle 20" BackgroundColor="White" StrokeThickness="0" Padding="20">
                        <Border.Shadow>
                            <Shadow Brush="Black" Offset="0,4" Radius="10" Opacity="0.05"/>
                        </Border.Shadow>
                        <VerticalStackLayout Spacing="15">
                            <Grid ColumnDefinitions="*, Auto">
                                <Label Text="ðŸ“– Giá»›i thiá»‡u ná»™i dung" FontSize="16" FontAttributes="Bold" TextColor="#1F2937" VerticalOptions="Center"/>

                                <Button x:Name="ReadDescriptionButton"
                                        Text="ðŸ”Š Nghe Ä‘á»c"
                                        Clicked="OnReadDescriptionClicked"
                                        Grid.Column="1"
                                        FontSize="12"
                                        HeightRequest="32"
                                        CornerRadius="16"
                                        Padding="12,0"
                                        BackgroundColor="#EEF2FF"
                                        TextColor="#6C63FF"
                                        FontAttributes="Bold"/>
                            </Grid>

                            <Label x:Name="DescriptionLabel" 
                                   FontSize="15" 
                                   TextColor="#4B5563" 
                                   LineHeight="1.5"
                                   LineBreakMode="WordWrap"/>
                        </VerticalStackLayout>
                    </Border>

                </VerticalStackLayout>

                <VerticalStackLayout x:Name="BorrowFrame" IsVisible="False" Spacing="15">
                    <Label Text="ÄÄ‚NG KÃ MÆ¯á»¢N" FontSize="13" FontAttributes="Bold" TextColor="#9CA3AF" Margin="10,0"/>

                    <Border StrokeShape="RoundRectangle 25" BackgroundColor="White" StrokeThickness="0" Padding="25">
                        <Border.Shadow>
                            <Shadow Brush="#6C63FF" Offset="0,8" Radius="20" Opacity="0.15"/>
                        </Border.Shadow>

                        <VerticalStackLayout Spacing="20">
                            <Grid ColumnDefinitions="Auto, *" RowDefinitions="Auto, Auto" ColumnSpacing="15">
                                <Border Grid.RowSpan="2" HeightRequest="50" WidthRequest="50" StrokeShape="RoundRectangle 15" BackgroundColor="#F3F4F6" StrokeThickness="0">
                                    <Label Text="ðŸ“…" FontSize="24" HorizontalOptions="Center" VerticalOptions="Center"/>
                                </Border>

                                <Label Grid.Column="1" Grid.Row="0" Text="Thá»i gian mÆ°á»£n (ngÃ y)" FontSize="12" TextColor="#6B7280"/>
                                <Entry x:Name="LoanDaysEntry" 
                                       Grid.Column="1" Grid.Row="1"
                                       Placeholder="Nháº­p sá»‘ ngÃ y (VD: 14)" 
                                       Keyboard="Numeric" 
                                       Text="14"
                                       TextColor="#1F2937"
                                       FontSize="18"
                                       FontAttributes="Bold"
                                       Margin="0,-5,0,0"
                                       BackgroundColor="Transparent"/>
                            </Grid>

                            <BoxView HeightRequest="1" Color="#F3F4F6"/>

                            <Grid ColumnDefinitions="Auto, *">
                                <Label Text="Háº¡n tráº£ dá»± kiáº¿n:" TextColor="#6B7280" FontSize="14"/>
                                <Label x:Name="DueDateLabel" 
                                       Grid.Column="1" 
                                       HorizontalOptions="End"
                                       TextColor="#6C63FF" 
                                       FontAttributes="Bold"/>
                            </Grid>

                            <Button x:Name="RequestBorrowButton"
                                    Text="Háº¹n mÆ°á»£n sÃ¡ch" 
                                    Clicked="OnRequestBorrowClicked"
                                    BackgroundColor="#6C63FF"
                                    TextColor="White"
                                    FontSize="16"
                                    FontAttributes="Bold"
                                    CornerRadius="25"
                                    HeightRequest="55"
                                    Margin="0,10,0,0">
                                <Button.Shadow>
                                    <Shadow Brush="#6C63FF" Offset="0,4" Radius="10" Opacity="0.4"/>
                                </Button.Shadow>
                            </Button>

                            <Border x:Name="BorrowStatusFrame"
                                    IsVisible="False"
                                    BackgroundColor="#FEF2F2"
                                    StrokeThickness="0"
                                    StrokeShape="RoundRectangle 10"
                                    Padding="15">
                                <Grid ColumnDefinitions="25, *">
                                    <Label Text="âš ï¸" VerticalOptions="Start" FontSize="16"/>
                                    <Label x:Name="BorrowStatusLabel" 
                                           Grid.Column="1"
                                           TextColor="#B91C1C"
                                           FontSize="13"
                                           LineBreakMode="WordWrap"/>
                                </Grid>
                            </Border>
                        </VerticalStackLayout>
                    </Border>
                </VerticalStackLayout>

            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>