<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="book.Pages.Admin.UserManagementPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             Title="Quáº£n lÃ½ NgÆ°á»i dÃ¹ng">
    <Grid RowDefinitions="Auto,*">
        <Frame Grid.Row="0" 
               Padding="15" 
               BackgroundColor="#FF2196F3"
               HasShadow="True"
               CornerRadius="0">
            <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="10">
                <Button Grid.Column="0" 
                        Text="â† Quay láº¡i" 
                        Clicked="OnBackClicked"
                        BackgroundColor="#FF1976D2"
                        TextColor="White"
                        CornerRadius="8"
                        WidthRequest="90"/>
                <Label Grid.Column="1" 
                       Text="ðŸ‘¥ Quáº£n lÃ½ NgÆ°á»i dÃ¹ng" 
                       FontSize="22" 
                       FontAttributes="Bold"
                       TextColor="White"
                       VerticalOptions="Center"
                       HorizontalOptions="Center"/>
                <Button Grid.Column="2" 
                        Text="âž• ThÃªm NgÆ°á»i dÃ¹ng" 
                        Clicked="OnAddUserClicked"
                        BackgroundColor="#FF4CAF50"
                        TextColor="White"
                        CornerRadius="8"
                        FontAttributes="Bold"
                        WidthRequest="140"/>
            </Grid>
        </Frame>
        
        <CollectionView x:Name="UsersCollection" 
                       Grid.Row="1"
                       ItemsSource="{Binding Users}">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Margin="15,10" 
                           Padding="20"
                           BackgroundColor="White"
                           BorderColor="#FFE0E0E0"
                           CornerRadius="15"
                           HasShadow="True">
                        <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="15">
                            <VerticalStackLayout Grid.Column="0" Spacing="8">
                                <Label Text="{Binding Username}" 
                                       FontSize="18" 
                                       FontAttributes="Bold"
                                       TextColor="#FF212121"/>
                                <Label Text="{Binding Email}" 
                                       FontSize="14"
                                       TextColor="#FF757575"/>
                                <Grid ColumnDefinitions="*,*" ColumnSpacing="10" Margin="0,5">
                                    <Label Grid.Column="0"
                                           Text="{Binding Role, StringFormat='ðŸ‘¤ {0}'}" 
                                           FontSize="12"
                                           TextColor="#FF9E9E9E"/>
                                    <Label Grid.Column="1"
                                           Text="{Binding IsActive, StringFormat='{0}'}" 
                                           FontSize="12"
                                           FontAttributes="Bold"
                                           TextColor="{Binding IsActive, Converter={StaticResource BoolToColorConverter}}"
                                           HorizontalOptions="End"/>
                                </Grid>
                                <Label Text="{Binding ReaderCardCode, StringFormat='ðŸªª Tháº»: {0}'}" 
                                       FontSize="12"
                                       TextColor="#FF9E9E9E"
                                       IsVisible="{Binding ReaderCardCode, Converter={StaticResource StringToBoolConverter}}"/>
                            </VerticalStackLayout>
                            <Button Grid.Column="1" 
                                    Text="ðŸ”‘ Äáº·t láº¡i" 
                                    Clicked="OnResetPasswordClicked"
                                    CommandParameter="{Binding .}"
                                    BackgroundColor="#FFFF9800"
                                    TextColor="White"
                                    CornerRadius="8"
                                    FontAttributes="Bold"
                                    FontSize="12"
                                    WidthRequest="100"
                                    HeightRequest="40"/>
                            <Button Grid.Column="2" 
                                    Text="{Binding IsActive, StringFormat='{0}'}" 
                                    Clicked="OnToggleActiveClicked"
                                    CommandParameter="{Binding .}"
                                    WidthRequest="100"
                                    HeightRequest="40"
                                    BackgroundColor="{Binding IsActive, Converter={StaticResource BoolToButtonColorConverter}}"
                                    TextColor="White"
                                    CornerRadius="8"
                                    FontAttributes="Bold"
                                    FontSize="12"/>
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>

