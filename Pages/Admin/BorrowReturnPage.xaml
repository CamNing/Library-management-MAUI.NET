<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="book.Pages.Admin.BorrowReturnPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:sys="clr-namespace:System;assembly=System.Runtime"
             Title="MÆ°á»£n/Tráº£">
    <Grid RowDefinitions="Auto,*">
        <Frame Grid.Row="0" 
               Padding="15" 
               BackgroundColor="#FF2196F3"
               HasShadow="True"
               CornerRadius="0">
            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="10">
                <Button Grid.Column="0" 
                        Text="â† Quay láº¡i" 
                        Clicked="OnBackClicked"
                        BackgroundColor="#FF1976D2"
                        TextColor="White"
                        CornerRadius="8"
                        WidthRequest="90"/>
                <Label Grid.Column="1" 
                       Text="ðŸ“– MÆ°á»£n/Tráº£" 
                       FontSize="22" 
                       FontAttributes="Bold"
                       TextColor="White"
                       VerticalOptions="Center"
                       HorizontalOptions="Center"/>
            </Grid>
        </Frame>
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Spacing="20" Padding="20">
                <Frame Padding="20"
                       BackgroundColor="White"
                       BorderColor="#FFE0E0E0"
                       CornerRadius="15"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="ðŸªª MÃ£ Tháº» Äá»™c giáº£" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               TextColor="#FF424242"/>
                        <Frame Padding="15"
                               BackgroundColor="#FFF5F5F5"
                               BorderColor="#FFE0E0E0"
                               CornerRadius="10"
                               HasShadow="False">
                            <Entry x:Name="CardCodeEntry" 
                                   Placeholder="Nháº­p mÃ£ tháº» (vÃ­ dá»¥: RC001001)"
                                   BackgroundColor="Transparent"
                                   TextColor="#FF212121"/>
                        </Frame>
                        <Label Text="ðŸ’¡ VÃ­ dá»¥: RC001001, RC001002" 
                               FontSize="13" 
                               TextColor="#FF757575"
                               Margin="0,-10,0,0"/>
                        <Button Text="ðŸ” Tra cá»©u Äá»™c giáº£" 
                                Clicked="OnLookupReaderClicked"
                                BackgroundColor="#FF2196F3"
                                TextColor="White"
                                CornerRadius="10"
                                FontAttributes="Bold"
                                HeightRequest="45"/>
                    </VerticalStackLayout>
                </Frame>

                <Frame x:Name="ReaderInfoFrame" 
                       IsVisible="False" 
                       Margin="0,10" 
                       Padding="20"
                       BackgroundColor="White"
                       BorderColor="#FFE0E0E0"
                       CornerRadius="15"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="10">
                        <Label x:Name="ReaderInfoLabel" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               TextColor="#FF212121"/>
                        <Label x:Name="ReaderEmailLabel" 
                               FontSize="14"
                               TextColor="#FF757575"/>
                        <Label x:Name="ReaderPhoneLabel" 
                               FontSize="14"
                               TextColor="#FF757575"/>
                    </VerticalStackLayout>
                </Frame>

                <Frame Padding="20"
                       BackgroundColor="White"
                       BorderColor="#FFE0E0E0"
                       CornerRadius="15"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="ðŸ“š SÃ¡ch CÃ³ sáºµn (Äá»ƒ MÆ°á»£n)" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               TextColor="#FF424242"/>
                        <CollectionView x:Name="BooksCollection" HeightRequest="200">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Frame Margin="5" 
                                           Padding="15"
                                           BackgroundColor="#FFF5F5F5"
                                           BorderColor="#FFE0E0E0"
                                           CornerRadius="10"
                                           HasShadow="False">
                                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                                            <CheckBox Grid.Column="0" 
                                                      IsChecked="{Binding IsSelected}" 
                                                      VerticalOptions="Center"
                                                      Color="#FF2196F3"/>
                                            <VerticalStackLayout Grid.Column="1" Spacing="5">
                                                <Label Text="{Binding Book.Title}" 
                                                       FontSize="15" 
                                                       FontAttributes="Bold"
                                                       TextColor="#FF212121"/>
                                                <Label Text="{Binding Book.ManagementCode, StringFormat='ðŸ·ï¸ MÃ£: {0}'}" 
                                                       FontSize="13"
                                                       TextColor="#FF757575"/>
                                                <Label Text="{Binding Book.AvailableQuantity, StringFormat='ðŸ“– CÃ³ sáºµn: {0}'}" 
                                                       FontSize="13"
                                                       FontAttributes="Bold"
                                                       TextColor="#FF4CAF50"/>
                                            </VerticalStackLayout>
                                        </Grid>
                                    </Frame>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                </Frame>

                <Frame Padding="20"
                       BackgroundColor="White"
                       BorderColor="#FFE0E0E0"
                       CornerRadius="15"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="ðŸ“– SÃ¡ch Äang MÆ°á»£n (Äá»ƒ Tráº£)" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               TextColor="#FF424242"/>
                        <CollectionView x:Name="LoansCollection" HeightRequest="200">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Frame Margin="5" 
                                           Padding="15"
                                           BackgroundColor="#FFF5F5F5"
                                           BorderColor="#FFE0E0E0"
                                           CornerRadius="10"
                                           HasShadow="False">
                                        <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                                            <CheckBox Grid.Column="0" 
                                                      IsChecked="{Binding IsSelected}" 
                                                      VerticalOptions="Center"
                                                      Color="#FF2196F3"/>
                                            <VerticalStackLayout Grid.Column="1" Spacing="5">
                                                <Label Text="{Binding BookTitle}" 
                                                       FontSize="15" 
                                                       FontAttributes="Bold"
                                                       TextColor="#FF212121"/>
                                                <Label Text="{Binding ManagementCode, StringFormat='ðŸ·ï¸ MÃ£: {0}'}" 
                                                       FontSize="13"
                                                       TextColor="#FF757575"/>
                                                <Label Text="{Binding Status, StringFormat='ðŸ“Š Tráº¡ng thÃ¡i: {0}'}" 
                                                       FontSize="13"
                                                       FontAttributes="Bold"
                                                       TextColor="#FF2196F3"/>
                                            </VerticalStackLayout>
                                        </Grid>
                                    </Frame>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                </Frame>

                <Frame Padding="20"
                       BackgroundColor="White"
                       BorderColor="#FFE0E0E0"
                       CornerRadius="15"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="â° Thá»i gian MÆ°á»£n" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               TextColor="#FF424242"/>
                        <Frame Padding="15"
                               BackgroundColor="#FFF5F5F5"
                               BorderColor="#FFE0E0E0"
                               CornerRadius="10"
                               HasShadow="False">
                            <VerticalStackLayout Spacing="10">
                                <Label Text="TÃ¹y chá»n 1: Nháº­p sá»‘ ngÃ y" 
                                       FontSize="14" 
                                       FontAttributes="Bold"
                                       TextColor="#FF424242"/>
                                <Entry x:Name="LoanDaysEntry" 
                                       Placeholder="Sá»‘ ngÃ y mÆ°á»£n (máº·c Ä‘á»‹nh: 14)" 
                                       Keyboard="Numeric" 
                                       Text="14"
                                       BackgroundColor="White"
                                       TextColor="#FF212121"/>
                                <Label x:Name="CalculatedDueDateLabel" 
                                       Text="" 
                                       FontSize="13" 
                                       TextColor="#FF757575"
                                       Margin="0,-5,0,0"/>
                            </VerticalStackLayout>
                        </Frame>
                        
                        <Frame Padding="15"
                               BackgroundColor="#FFF5F5F5"
                               BorderColor="#FFE0E0E0"
                               CornerRadius="10"
                               HasShadow="False">
                            <VerticalStackLayout Spacing="10">
                                <Label Text="TÃ¹y chá»n 2: Chá»n ngÃ y háº¿t háº¡n cá»¥ thá»ƒ" 
                                       FontSize="14" 
                                       FontAttributes="Bold"
                                       TextColor="#FF424242"/>
                                <DatePicker x:Name="DueDatePicker" 
                                           MinimumDate="{Binding Source={x:Static sys:DateTime.Now}}"
                                           TextColor="#FF212121"/>
                                <Label Text="ðŸ’¡ Äá»ƒ trá»‘ng Ä‘á»ƒ sá»­ dá»¥ng sá»‘ ngÃ y" 
                                       FontSize="12" 
                                       TextColor="#FF757575"
                                       Margin="0,-5,0,0"/>
                            </VerticalStackLayout>
                        </Frame>
                    </VerticalStackLayout>
                </Frame>

                <Button Text="ðŸ“– MÆ°á»£n SÃ¡ch" 
                        Clicked="OnBorrowClicked"
                        BackgroundColor="#FF4CAF50"
                        TextColor="White"
                        CornerRadius="12"
                        FontAttributes="Bold"
                        FontSize="16"
                        HeightRequest="50"/>
                
                <Frame x:Name="VerificationFrame" 
                       IsVisible="False" 
                       Margin="0,10" 
                       Padding="20"
                       BackgroundColor="#E3F2FD"
                       BorderColor="#FFBBDEFB"
                       CornerRadius="15"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="ðŸ“§ MÃ£ xÃ¡c minh Ä‘Ã£ Ä‘Æ°á»£c gá»­i Ä‘áº¿n email cá»§a Ä‘á»™c giáº£" 
                               FontSize="15" 
                               FontAttributes="Bold"
                               TextColor="#1976D2"/>
                        <Label Text="Vui lÃ²ng nháº­p mÃ£ xÃ¡c minh 6 sá»‘:" 
                               FontSize="14"
                               TextColor="#FF424242"/>
                        <Frame Padding="15"
                               BackgroundColor="White"
                               BorderColor="#FFBBDEFB"
                               CornerRadius="10"
                               HasShadow="False">
                            <Entry x:Name="VerificationCodeEntry" 
                                   Placeholder="Nháº­p mÃ£ 6 sá»‘ (vÃ­ dá»¥: 123456)" 
                                   Keyboard="Numeric"
                                   MaxLength="6"
                                   FontSize="18"
                                   FontAttributes="Bold"
                                   HorizontalTextAlignment="Center"
                                   BackgroundColor="Transparent"
                                   TextColor="#FF212121"/>
                        </Frame>
                        <Label x:Name="VerificationStatusLabel" 
                               Text="" 
                               FontSize="13"
                               TextColor="#FF424242"
                               Margin="0,-5,0,0"/>
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="15">
                            <Button Grid.Column="0" 
                                    Text="âœ… XÃ¡c nháº­n" 
                                    Clicked="OnConfirmBorrowClicked"
                                    BackgroundColor="#FF4CAF50"
                                    TextColor="White"
                                    CornerRadius="10"
                                    FontAttributes="Bold"
                                    HeightRequest="45"/>
                            <Button Grid.Column="1" 
                                    Text="âŒ Há»§y" 
                                    Clicked="OnCancelVerificationClicked"
                                    BackgroundColor="#FFF44336"
                                    TextColor="White"
                                    CornerRadius="10"
                                    FontAttributes="Bold"
                                    HeightRequest="45"/>
                        </Grid>
                    </VerticalStackLayout>
                </Frame>
                
                <Button Text="ðŸ“¤ Tráº£ SÃ¡ch" 
                        Clicked="OnReturnClicked"
                        BackgroundColor="#FFFF9800"
                        TextColor="White"
                        CornerRadius="12"
                        FontAttributes="Bold"
                        FontSize="16"
                        HeightRequest="50"/>
                
                <Frame x:Name="ReturnVerificationFrame" 
                       IsVisible="False" 
                       Margin="0,10" 
                       Padding="20"
                       BackgroundColor="#FFF3E0"
                       BorderColor="#FFE0B2A0"
                       CornerRadius="15"
                       HasShadow="True">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="ðŸ“§ MÃ£ xÃ¡c minh Ä‘Ã£ Ä‘Æ°á»£c gá»­i Ä‘áº¿n email cá»§a Ä‘á»™c giáº£" 
                               FontSize="15" 
                               FontAttributes="Bold"
                               TextColor="#E65100"/>
                        <Label Text="Vui lÃ²ng nháº­p mÃ£ xÃ¡c minh 6 sá»‘:" 
                               FontSize="14"
                               TextColor="#FF424242"/>
                        <Frame Padding="15"
                               BackgroundColor="White"
                               BorderColor="#FFE0B2A0"
                               CornerRadius="10"
                               HasShadow="False">
                            <Entry x:Name="ReturnVerificationCodeEntry" 
                                   Placeholder="Nháº­p mÃ£ 6 sá»‘ (vÃ­ dá»¥: 123456)" 
                                   Keyboard="Numeric"
                                   MaxLength="6"
                                   FontSize="18"
                                   FontAttributes="Bold"
                                   HorizontalTextAlignment="Center"
                                   BackgroundColor="Transparent"
                                   TextColor="#FF212121"/>
                        </Frame>
                        <Label x:Name="ReturnVerificationStatusLabel" 
                               Text="" 
                               FontSize="13"
                               TextColor="#FF424242"
                               Margin="0,-5,0,0"/>
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="15">
                            <Button Grid.Column="0" 
                                    Text="âœ… XÃ¡c nháº­n" 
                                    Clicked="OnConfirmReturnClicked"
                                    BackgroundColor="#FF4CAF50"
                                    TextColor="White"
                                    CornerRadius="10"
                                    FontAttributes="Bold"
                                    HeightRequest="45"/>
                            <Button Grid.Column="1" 
                                    Text="âŒ Há»§y" 
                                    Clicked="OnCancelReturnVerificationClicked"
                                    BackgroundColor="#FFF44336"
                                    TextColor="White"
                                    CornerRadius="10"
                                    FontAttributes="Bold"
                                    HeightRequest="45"/>
                        </Grid>
                    </VerticalStackLayout>
                </Frame>

                <ActivityIndicator x:Name="LoadingIndicator" 
                                  IsRunning="False" 
                                  IsVisible="False" 
                                  Color="#FF2196F3"
                                  Margin="0,10"/>
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>

